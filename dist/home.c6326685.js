function e(e,t,o,r){Object.defineProperty(e,t,{get:o,set:r,enumerable:!0,configurable:!0})}var t=globalThis,o={},r={},n=t.parcelRequire2955;null==n&&((n=function(e){if(e in o)return o[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},t.parcelRequire2955=n);var a=n.register;a("aDxBx",function(t,o){e(t.exports,"initScrollHandler",()=>a),e(t.exports,"removeHeader",()=>l),e(t.exports,"elasticScroll",()=>s),e(t.exports,"navScroller",()=>c),e(t.exports,"scrollReveal",()=>d);var r=n("8nUlx");let a=()=>{let e=(0,r.getElement)("header"),t=0,o=0,n=()=>e.classList.remove("collapse"),a=()=>e.classList.add("collapse");window.addEventListener("scroll",()=>{let e=window.pageYOffset||document.documentElement.scrollTop;o<15?a():n(),o=o*(t-e)<0?0:o+(t-e)*.1,t=e})},l=()=>{let e=(0,r.getElement)("#home-section"),t=(0,r.getElement)("header");new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?t.classList.remove("collapse","dark"):t.classList.add("collapse","dark")})},{threshold:.3}).observe(e)},s=()=>{let e=document.getElementById("whole-content"),t=0,o=!1,r=!1;document.addEventListener("touchstart",e=>{(window.innerHeight+window.scrollY>=document.body.offsetHeight||0===window.scrollY)&&(t=e.touches[0].pageY,o=!0,r=0===window.scrollY)},{passive:!0}),document.addEventListener("touchmove",n=>{if(o){let o=n.touches[0].pageY-t;r?e.style.transform=`translateY(${-(.1*o)}px)`:e.style.transform=`translateY(${o<0?.01*o:0}px)`}},{passive:!0}),document.addEventListener("touchend",()=>{o&&(e.style.transform=""),o=!1})},i=e=>{let t=e.getAttribute("href"),o=(0,r.getElement)(t).offsetTop,n=(0,r.getElement)("header").offsetHeight,a=window.innerHeight;(o<window.scrollY||o>window.scrollY+a)&&window.scrollTo({top:o-n,behavior:"smooth"})},c=()=>{(0,r.getElement)("nav");let e=(0,r.getElements)(".nav-links"),t=(0,r.getElements)(".btns--nav");e.forEach(e=>{e.addEventListener("click",e=>{let t=e.target.closest(".nav-link");t&&(e.preventDefault(),i(t))})}),t.forEach(e=>{e.addEventListener("click",e=>{let t=e.target.closest(".btn--nav");t&&(e.preventDefault(),i(t))})})};function d(){let e=(0,r.getElements)("section:not(#home-section)"),t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.style.transform="translateY(0)",e.target.style.opacity=1)})});e.forEach(e=>{t.observe(e)})}}),a("8nUlx",function(t,o){e(t.exports,"getElement",()=>l),e(t.exports,"getElements",()=>s),e(t.exports,"setElementText",()=>i),e(t.exports,"setBookCoverImage",()=>c),e(t.exports,"setError",()=>d);var r=n("jXPZz"),a=n("d6kRO");let l=e=>document.querySelector(e),s=e=>document.querySelectorAll(e),i=(e,t)=>{s(e).forEach(e=>e.textContent=t)};function c(e){e=e.replace("http://","https://"),l("#home-section").style.backgroundImage=`url(${e})`;let t=new Image;t.src=e,t.onload=()=>{r.stateVariables.coverLoaded=!0,r.stateVariables.mockupLoaded&&(0,a.loadPage)()}}function d(e,t="#whole-content"){let o=`<div class="error">${e}</div>`;l(t).insertAdjacentHTML("beforeend",o)}}),a("jXPZz",function(t,o){e(t.exports,"API_CONFIG",()=>r),e(t.exports,"stateVariables",()=>n);let r={BGREMOVER:"/remove_bg",RECOMMEND_URL:"/suggestions",TOP_50:"/top50",RESULT_PER_PAGE:9,GOOGLE_URL:"/search",MOCKUP_URL:"/mockup"},n={mockupLoaded:!1,bgImageLoaded:!1}}),a("d6kRO",function(t,o){e(t.exports,"loadPage",()=>s);var r=n("aDxBx");n("h2RTM");var a=n("7iS0B"),l=n("8nUlx");let s=()=>{(0,l.getElement)(".loader").style.display="none",(0,l.getElement)("#whole-content").style.display="block",(0,l.getElement)(".error")&&((0,l.getElement)(".error").style.display="none")};document.addEventListener("DOMContentLoaded",()=>{(0,r.initScrollHandler)(),(0,r.removeHeader)(),(0,r.elasticScroll)(),(0,r.navScroller)(),(0,r.scrollReveal)();let e=new URLSearchParams(window.location.search).get("book");(0,a.getBook)(e).then(e=>{(0,a.setWebpageData)(e)}).catch(e=>{(0,l.setError)(e,"body"),(0,l.getElement)(".loader").style.display="none",(0,l.getElement)("#whole-content").style.display="none"})})}),a("h2RTM",function(e,t){n("8nUlx")}),a("7iS0B",function(t,o){e(t.exports,"getBook",()=>g),e(t.exports,"setWebpageData",()=>p);var r=n("6FAcS"),a=n("8nUlx"),l=n("hbrhs"),s=n("7Hclf"),i=n("jXPZz"),c=n("7lblR"),d=n("4WPy0");let{GOOGLE_URL:u}=i.API_CONFIG,h=e=>{let t=(0,a.getElements)(".book-list .book");Object.entries(e).forEach(([e,o],r)=>{let{author:n,image:a}=o;t[r].querySelector("img").src=a,t[r].querySelector(".name").textContent=e,t[r].querySelector(".author-name").textContent=n;let l=`/book?book=${encodeURIComponent(e)}`;t[r].dataset.url=l}),(0,d.handleDataUrl)()},m=e=>{(0,l.getAuthor)(e[0]).then(e=>{if(""===e.bio){(0,a.getElement)("#about-author").style.display="none";return}if((0,a.setElementText)(".author-name",e.name),e.image){let t="author_image_"+e.name;(0,r.removeBackground)(e.image,t).then(t=>{(0,a.getElement)("#author-img img").src=t.file_path??e.image})}(0,a.getElement)("#about-author .content p").textContent=e.bio,(0,a.getElement)(".author-url").href=e.url}).catch(e=>{console.error(e),(0,a.getElement)("#about-author").style.display="none"})},g=async e=>{try{let t;let o=`${u}?q=${e}`,n=await (0,r.getData)(o),a=n.items[0].searchInfo?.textSnippet||"",l=n.items[0].selfLink,i=await (0,r.getData)(l);try{t=await (0,s.getRecommendations)(e)}catch(e){console.error(e),t=null}return{title:i.volumeInfo.title,subtitle:i.volumeInfo.subtitle,authors:i.volumeInfo.authors,description:i.volumeInfo.description,thumbnail:i.volumeInfo.imageLinks?.thumbnail??"https://via.placeholder.com/150",infoLink:i.volumeInfo.infoLink,largeImage:i.volumeInfo.imageLinks?.large||null,rating:i.volumeInfo.averageRating,buyLink:i.saleInfo.buyLink,previewLink:i.accessInfo?.webReaderLink||"https://books.google.com/",categories:i.volumeInfo.categories.map(e=>e.split("/").slice(-1)[0]),shortInfo:a,reccomends:t}}catch(e){throw console.error(e),e}},p=e=>{let{title:t,subtitle:o,previewLink:r,authors:n,description:l,thumbnail:s,largeImage:i,buyLink:d,categories:u,shortInfo:g,reccomends:p}=e,f=u[1],v=u[0],E=`${t} | ${o||""} | A book by ${n.join(", ")}`;document.title=E,(0,a.setElementText)(".b-name",t),(0,a.setElementText)(".author-name",n.join(", ")),(0,a.setElementText)(".short-info",g.slice(0,200)+"..."),(0,a.getElement)(".user-categories").innerHTML=u.map(e=>`<li>${e}</li>`).join(""),(0,a.getElements)(".order-link").forEach(e=>e.href=d),(0,a.getElements)(".preview-link").forEach(e=>e.href=r),(0,a.getElements)(".genre").forEach(e=>e.textContent=f),(0,a.getElements)(".sub-genre").forEach(e=>e.textContent=v),(0,a.getElement)("#description").innerHTML=l,(0,a.setBookCoverImage)(s),(0,c.renderMockup)(s,t),m(n),p?h(p):(0,a.getElement)("#recommended-books").style.display="none"}}),a("6FAcS",function(t,o){e(t.exports,"getData",()=>s),e(t.exports,"postData",()=>i),e(t.exports,"removeBackground",()=>c);var r=n("jXPZz"),a=n("1a5vu");let l=e=>new Promise((t,o)=>setTimeout(()=>o("Response Timeout!! Internet Connection too slow"),e)),s=async(e,t=null,o=!0)=>{try{let r=(0,a.default).get(e);if(r)return r;let n=await Promise.race([fetch(e,t),l(2e4)]);if(!n.ok)throw Error(`HTTP error! status: ${n.status}`);if(!o)return n;let s=await n.json();return(0,a.default).set(e,s),s}catch(e){throw console.error(e),e}},i=async(e,t)=>{try{let o=t.file_name,r=(0,a.default).get(o);if(r)return r;let n=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});if(!n.ok)throw Error(`HTTP error! status: ${n.status}`);if(200!==n.status)return[];let l=await n.json();return(0,a.default).set(o,l),l}catch(e){throw e}},c=async(e,t)=>{let o=(0,a.default).get(t);if(o)return o;let n=`${r.API_CONFIG.BGREMOVER}?file_path=${e}&file_name=${t}`;try{let e=await s(n);return(0,a.default).set(t,e),e}catch(e){throw console.error(e),e}}}),a("1a5vu",function(t,o){e(t.exports,"default",()=>r);var r=new class{constructor(e){this.name=e,this.cache=localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):{},this.limit=25}set(e,t){if(this.cache[e]=t,Object.keys(this.cache).length>this.limit){let e=Object.keys(this.cache);delete this.cache[e[0]]}localStorage.setItem(this.name,JSON.stringify(this.cache))}get(e){return this.cache[e]}delete(e){delete this.cache[e],localStorage.setItem(this.name,JSON.stringify(this.cache))}}("cachedForYourConvenienceOnly")}),a("hbrhs",function(t,o){e(t.exports,"getAuthor",()=>l);var r=n("6FAcS");let a=e=>`https://covers.openlibrary.org/b/id/${e}-L.jpg`,l=async e=>{let t=`https://openlibrary.org/search/authors.json?q=${e}`,o=(await (0,r.getData)(t)).docs[0].key,n=`https://openlibrary.org/authors/${o}.json`,l=await (0,r.getData)(n);return{name:l.name,image:l.photos?a(l.photos[0]):null,bio:l.bio?.value||l.bio||"",url:l.links?l.links[0].url:"#"}}}),a("7Hclf",function(t,o){e(t.exports,"getRecommendations",()=>s);var r=n("jXPZz"),a=n("6FAcS");let{RECOMMEND_URL:l}=r.API_CONFIG,s=async e=>{try{return await (0,a.postData)(l,{name:e})}catch(e){throw e}}}),a("7lblR",function(t,o){e(t.exports,"renderMockup",()=>i);var r=n("jXPZz"),a=n("6FAcS"),l=n("d6kRO");let s=e=>{document.querySelectorAll(".book-img img").forEach(t=>{t.src=e,t.addEventListener("load",()=>{r.stateVariables.mockupLoaded=!0,r.stateVariables.coverLoaded&&(0,l.loadPage)()})})},i=async(e,t)=>{e=e.replace("http://","https://");let o=r.API_CONFIG.MOCKUP_URL,n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({nr:1404,layer_inputs:[{id:"jujmugkht9uyhlb6sjd",data:e,checked:!0},{id:"jujmugkhplsvkwqyyxg",checked:!0,color:{red:0,green:0,blue:0}}]})};try{let e=await (0,a.postData)(o,{options:n,file_name:"mockup_"+t});if(!e)throw r.stateVariables.coverLoaded&&(0,l.loadPage)(),Error(e.message);let i=e.file_path;s(i)}catch(e){throw console.error(e),e}}}),a("4WPy0",function(t,o){e(t.exports,"handleDataUrl",()=>a),e(t.exports,"handleBatchDataUrl",()=>l);var r=n("8nUlx");let a=()=>{document.querySelectorAll("[data-url]").forEach(e=>{let t=e.getAttribute("data-url");e.addEventListener("click",e=>{e.preventDefault(),window.location.href=t})})},l=()=>{(0,r.getElement)(".books").addEventListener("click",e=>{let t=e.target.closest("[data-url]");if(!t)return;e.preventDefault();let o=t.getAttribute("data-url");window.location.href=o})}}),n("d6kRO");
//# sourceMappingURL=home.c6326685.js.map
